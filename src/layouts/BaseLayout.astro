---
import { ViewTransitions } from 'astro:transitions';

export interface Props {
  title: string;
  description?: string;
}

const { 
  title = "NewBridge Living | Sober Living Homes in Tallahassee, FL",
  description = "Quality sober living homes in Tallahassee, FL. Structured environment, 24/7 support, and proven recovery programs. Call today." 
} = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    
    <!-- Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Mobile Optimizations -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#059669">
    
    <!-- Social Media & SEO -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    
    <ViewTransitions />
  </head>
  
  <body class="font-sans antialiased bg-white text-gray-900">
    <!-- Navigation -->
    <nav 
      id="main-nav" 
      class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-lg border-b border-emerald-100/50 transition-all duration-300"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
          <!-- Logo -->
          <div class="flex items-center">
            <a href="/" class="flex items-center space-x-3 group">
              <div class="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-2 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
              </div>
              <div class="hidden sm:block">
                <h1 class="text-xl font-bold text-gray-900 group-hover:text-emerald-600 transition-colors duration-300">NewBridge Living</h1>
                <p class="text-xs text-emerald-600 font-medium">Sober Living Homes</p>
              </div>
            </a>
          </div>

          <!-- Desktop Navigation -->
          <div class="hidden md:flex items-center space-x-8">
            <a href="/" class="text-gray-700 hover:text-emerald-600 font-medium transition-colors duration-300">Home</a>
            <a href="/facilities" class="text-gray-700 hover:text-emerald-600 font-medium transition-colors duration-300">Our Homes</a>
            <a href="/#about" class="text-gray-700 hover:text-emerald-600 font-medium transition-colors duration-300 smooth-scroll">About</a>
            <a href="/#programs" class="text-gray-700 hover:text-emerald-600 font-medium transition-colors duration-300 smooth-scroll">Programs</a>
            <a href="/#contact" class="text-gray-700 hover:text-emerald-600 font-medium transition-colors duration-300 smooth-scroll">Contact</a>
            <a href="/admin" class="bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-lg font-semibold transition-all duration-300">CRM Login</a>
          </div>

          <!-- Mobile Menu Button -->
          <button id="mobile-menu-button" class="md:hidden p-2 rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors duration-300">
            <div class="space-y-1.5">
              <div class="w-6 h-0.5 bg-current transition-transform duration-300"></div>
              <div class="w-6 h-0.5 bg-current transition-opacity duration-300"></div>
              <div class="w-6 h-0.5 bg-current transition-transform duration-300"></div>
            </div>
          </button>
        </div>
      </div>
      
      <!-- Mobile Menu Overlay -->
      <div id="mobile-menu-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm opacity-0 invisible transition-all duration-300 md:hidden"></div>
      
      <!-- Mobile Menu -->
      <div id="mobile-menu" class="fixed top-0 right-0 h-full w-80 bg-emerald-900 transform translate-x-full transition-transform duration-300 md:hidden z-50">
        <div class="p-6">
          <div class="flex items-center justify-between mb-8">
            <h2 class="text-white text-xl font-bold">Navigation</h2>
            <button id="mobile-menu-close" class="text-emerald-200 hover:text-white p-2">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <nav class="space-y-4">
            <ul class="space-y-4 mobile-nav-links">
              <li><a href="/" class="text-emerald-200 hover:text-white transition-colors duration-300 flex items-center group text-lg smooth-scroll">
                <svg class="w-4 h-4 mr-3 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                Home
              </a></li>
              <li><a href="/facilities" class="text-emerald-200 hover:text-white transition-colors duration-300 flex items-center group text-lg smooth-scroll">
                <svg class="w-4 h-4 mr-3 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                Our Homes
              </a></li>
              <li><a href="#about" class="text-emerald-200 hover:text-white transition-colors duration-300 flex items-center group text-lg smooth-scroll">
                <svg class="w-4 h-4 mr-3 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                About Us
              </a></li>
              <li><a href="#programs" class="text-emerald-200 hover:text-white transition-colors duration-300 flex items-center group text-lg smooth-scroll">
                <svg class="w-4 h-4 mr-3 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                Programs
              </a></li>
              <li><a href="#contact" class="text-emerald-200 hover:text-white transition-colors duration-300 flex items-center group text-lg smooth-scroll">
                <svg class="w-4 h-4 mr-3 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                Contact
              </a></li>
              <li class="pt-4">
                <a href="/admin" class="bg-white text-emerald-900 px-6 py-3 rounded-lg font-semibold hover:bg-emerald-50 transition-all duration-300 flex items-center justify-center">
                  CRM Login
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20">
      <slot />
    </main>

    <!-- Footer -->
    <footer class="bg-emerald-900 text-white py-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <!-- Company Info -->
          <div class="md:col-span-2">
            <div class="flex items-center space-x-3 mb-6">
              <div class="bg-emerald-600 rounded-2xl p-2">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold">NewBridge Living</h3>
                <p class="text-emerald-200 text-sm">Sober Living Homes</p>
              </div>
            </div>
            <p class="text-emerald-100 mb-6 max-w-md">
              Providing safe, structured sober living environments for men in recovery. 
              Professional staff, proven programs, and a supportive community.
            </p>
            <div class="space-y-2">
              <p class="text-emerald-200">üìç Tallahassee, Florida</p>
              <p class="text-emerald-200">üìû (850) 555-HOPE</p>
              <p class="text-emerald-200">‚úâÔ∏è info@newbridgeliving.com</p>
            </div>
          </div>

          <!-- Quick Links -->
          <div>
            <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
            <ul class="space-y-2">
              <li><a href="/" class="text-emerald-200 hover:text-white transition-colors duration-300">Home</a></li>
              <li><a href="/facilities" class="text-emerald-200 hover:text-white transition-colors duration-300">Our Homes</a></li>
              <li><a href="/#about" class="text-emerald-200 hover:text-white transition-colors duration-300">About Us</a></li>
              <li><a href="/#programs" class="text-emerald-200 hover:text-white transition-colors duration-300">Programs</a></li>
              <li><a href="/#contact" class="text-emerald-200 hover:text-white transition-colors duration-300">Contact</a></li>
            </ul>
          </div>

          <!-- Emergency Contact -->
          <div>
            <h4 class="text-lg font-semibold mb-4">24/7 Support</h4>
            <div class="bg-emerald-800 rounded-xl p-4 border border-emerald-700">
              <p class="text-emerald-200 text-sm mb-2">Crisis Hotline</p>
              <p class="text-white font-bold text-lg">(850) 555-HOPE</p>
              <p class="text-emerald-200 text-xs mt-2">Available 24/7</p>
            </div>
          </div>
        </div>

        <div class="border-t border-emerald-800 mt-12 pt-8 text-center">
          <p class="text-emerald-200">&copy; 2025 NewBridge Living. All rights reserved. Licensed Sober Living Facility.</p>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Get DOM elements with proper type checking
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
        const mobileMenuClose = document.getElementById('mobile-menu-close');
        const mobileNavLinks = document.querySelectorAll('.mobile-nav-links a');
        const burgerLines = document.querySelectorAll('#mobile-menu-button > div > div');

        function openMobileMenu() {
          if (!mobileMenu || !mobileMenuOverlay) return;
          
          mobileMenu.classList.remove('translate-x-full');
          mobileMenu.classList.add('translate-x-0');
          mobileMenuOverlay.classList.remove('opacity-0', 'invisible');
          mobileMenuOverlay.classList.add('opacity-100', 'visible');
          document.body.style.overflow = 'hidden';
          
          // Animate burger to X
          if (burgerLines[0]) (burgerLines[0] as HTMLElement).style.transform = 'rotate(45deg) translate(4px, 4px)';
          if (burgerLines[1]) (burgerLines[1] as HTMLElement).style.opacity = '0';
          if (burgerLines[2]) (burgerLines[2] as HTMLElement).style.transform = 'rotate(-45deg) translate(5px, -5px)';
        }

        function closeMobileMenu() {
          if (!mobileMenu || !mobileMenuOverlay) return;
          
          mobileMenu.classList.add('translate-x-full');
          mobileMenu.classList.remove('translate-x-0');
          mobileMenuOverlay.classList.add('opacity-0', 'invisible');
          mobileMenuOverlay.classList.remove('opacity-100', 'visible');
          document.body.style.overflow = '';
          
          // Animate X back to burger
          if (burgerLines[0]) (burgerLines[0] as HTMLElement).style.transform = '';
          if (burgerLines[1]) (burgerLines[1] as HTMLElement).style.opacity = '1';
          if (burgerLines[2]) (burgerLines[2] as HTMLElement).style.transform = '';
        }

        mobileMenuButton?.addEventListener('click', openMobileMenu);
        mobileMenuClose?.addEventListener('click', closeMobileMenu);
        mobileMenuOverlay?.addEventListener('click', closeMobileMenu);

        // Close menu when clicking nav links
        mobileNavLinks.forEach(link => {
          link.addEventListener('click', closeMobileMenu);
        });

        // Enhanced smooth scrolling with proper offset for fixed header
        function smoothScrollToElement(targetId: string) {
          const target = document.querySelector(targetId);
          if (target) {
            const headerHeight = 80; // Height of fixed navigation
            const targetPosition = target.getBoundingClientRect().top + window.pageYOffset - headerHeight;
            
            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });
          }
        }

        // Enhanced smooth scrolling for all internal links
        document.querySelectorAll('.smooth-scroll, a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function (e) {
            const target = e.currentTarget as HTMLElement | null;
            if (!target) return;
            
            const href = target.getAttribute('href');
            if (href && href.startsWith('#') && href !== '#') {
              e.preventDefault();
              
              // Close mobile menu if open
              closeMobileMenu();
              
              // Add slight delay for mobile menu close animation
              setTimeout(() => {
                smoothScrollToElement(href);
              }, 100);
            }
          });
        });

        // Professional navigation scroll behavior
        let lastScrollTop = 0;
        const nav = document.getElementById('main-nav');
        
        window.addEventListener('scroll', () => {
          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          
          if (scrollTop > lastScrollTop && scrollTop > 100) {
            // Scrolling down
            nav?.classList.add('-translate-y-full');
          } else {
            // Scrolling up
            nav?.classList.remove('-translate-y-full');
          }
          
          // Add background blur on scroll
          if (scrollTop > 10) {
            nav?.classList.add('bg-white/98', 'shadow-xl', 'border-emerald-200');
            nav?.classList.remove('bg-white/95', 'border-emerald-100/50');
          } else {
            nav?.classList.remove('bg-white/98', 'shadow-xl', 'border-emerald-200');
            nav?.classList.add('bg-white/95', 'border-emerald-100/50');
          }
          
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
        });
      });
    </script>
  </body>
</html>